var PrintersList={list:null,pagingTop:null,pagingBottom:null,pagingText:null,printers:[],pagingInfo:{currentPage:0,totalCount:0,perPage:cfg.itemsPerPage},init:function(){this.list=document.getElementById("list");this.pagingTop=document.getElementById("paging_top");this.pagingBottom=document.getElementById("paging_bottom");this.pagingText=document.getElementById("paging_text");this.pagingTop.onclick=function(){"disabled"!=this.className&&PrintersList.show(PrintersList.pagingInfo.currentPage-1)};this.pagingBottom.onclick=
function(){"disabled"!=this.className&&PrintersList.show(PrintersList.pagingInfo.currentPage+1)};for(j=0;j<this.pagingInfo.perPage;j++)this.list.children[j].children[0].onclick=this.selectPrinter;this.requestPrinterList()},show:function(a){var c=PrintersList.printers;this.pagingInfo.currentPage=a;this.pagingInfo.totalCount=0<c.length?c.length:1;this.pagingText.innerText=a+1+"/"+Math.ceil(this.pagingInfo.totalCount/this.pagingInfo.perPage);for(var b=0,d=c.length-1-a*this.pagingInfo.perPage;0<=d&&b<
this.pagingInfo.perPage;d--,b++)this.list.children[b].children[0].children[0].innerHTML=c[d].name,this.list.children[b].children[0].children[1].innerHTML="<div>"+c[d].ip+"</div> <div></div>",this.list.children[b].children[0].printer=JSON.stringify(c[d]),this.list.children[b].style.setProperty("visibility","visible");if(b<this.pagingInfo.perPage)for(b;b<this.pagingInfo.perPage;b++)this.list.children[b].children[0].children[0].innerHTML="Empty",this.list.children[b].style.setProperty("visibility","hidden");
a+1==Math.ceil(this.pagingInfo.totalCount/this.pagingInfo.perPage)?this.pagingBottom.className="disabled":this.pagingBottom.className="enabled";this.pagingTop.className=0==a?"disabled":"enabled"},selectPrinter:function(a){window.localStorage.setItem("selectedPrinter",a.currentTarget.printer);window.location="prenota.html"},requestPrinterList:function(){ajaxRequest("GET","php/get_printer_list.php",function(a){try{a&&(PrintersList.printers=JSON.parse(a)),PrintersList.show(0)}catch(c){alert(response)}})}};
function answerCotization(a){a&&(window.location="cotization_number.html")}function cotization_verification(){confirm("\u00bfVenta Pagos Fijos?",answerCotization)}asl.title("Impresoras");asl.options(null);asl.back(function(){window.location="prenota.html"});asl.events.subscribe(asl.events.types.exit,function(){asl.badge(null);"function"==typeof asl.lock&&asl.lock(null)});var isCotization;
asl.events.subscribe(asl.events.types.loaded,function(){PrintersList.init();isCotization=JSON.parse(window.localStorage.getItem("answerOfCotization"));(isFirstPrint=JSON.parse(window.localStorage.getItem("nueva_prenota")))&&null==isCotization&&cotization_verification()});