var SerialList={list:null,pagingTop:null,pagingBottom:null,pagingText:null,aSerial:[],pagingInfo:{currentPage:0,totalCount:0,perPage:cfg.itemsPerPage},init:function(){this.list=document.getElementById("list");this.pagingTop=document.getElementById("paging_top");this.pagingBottom=document.getElementById("paging_bottom");this.pagingText=document.getElementById("paging_text");this.pagingTop.onclick=function(){"disabled"!=this.className&&SerialList.show(SerialList.pagingInfo.currentPage-1)};this.pagingBottom.onclick=
function(){"disabled"!=this.className&&SerialList.show(SerialList.pagingInfo.currentPage+1)};for(j=0;j<this.pagingInfo.perPage;j++)this.list.children[j].onclick=this.selectSerial;var a=JSON.parse(window.localStorage.getItem("product")),b="";a&&(a.ItemTypeID==ItemType.SERIE?b="Serial":a.ItemTypeID==ItemType.LOTE&&(b="Lote"),this.requestSerialList(a.ID,a.optionID));asl.title(b)},requestSerialList:function(a,b){ajaxRequest("GET","php/db/get_item_serial_list.php?ItemID="+a+"&combinationID="+b,function(a){try{var b=
JSON.parse(a);b&&(SerialList.aSerial=b);SerialList.show(0)}catch(e){alert(a)}})},show:function(a){var b=SerialList.aSerial;this.pagingInfo.currentPage=a;this.pagingInfo.totalCount=0<b.length?b.length:1;this.pagingText.innerText=a+1+"/"+Math.ceil(this.pagingInfo.totalCount/this.pagingInfo.perPage);for(var c=0,d=b.length-1-a*this.pagingInfo.perPage;0<=d&&c<this.pagingInfo.perPage;d--,c++)this.list.children[c].children[0].children[0].innerHTML=b[d].SerialBatch,this.list.children[c].id=d,this.list.children[c].children[0].children[1].children[1].innerHTML=
parseFloat(b[d].Quantity)||0,this.list.children[c].style.setProperty("visibility","visible");if(c<this.pagingInfo.perPage)for(c;c<this.pagingInfo.perPage;c++)this.list.children[c].children[0].children[0].innerHTML="Empty",this.list.children[c].style.setProperty("visibility","hidden");a+1==Math.ceil(this.pagingInfo.totalCount/this.pagingInfo.perPage)?this.pagingBottom.className="disabled":this.pagingBottom.className="enabled";this.pagingTop.className=0==a?"disabled":"enabled"},selectSerial:function(a){a=
parseInt(a.currentTarget.id);window.localStorage.setItem("oSelectedSerial",JSON.stringify(SerialList.aSerial[a]));window.location="scan_product.html"}};function backToProducts(){window.location="scan_product.html"}asl.options(null);asl.back(backToProducts);asl.events.subscribe(asl.events.types.exit,function(){asl.badge(null);"function"==typeof asl.lock&&asl.lock(null)});asl.events.subscribe(asl.events.types.loaded,function(){SerialList.init()});