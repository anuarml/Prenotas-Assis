var SerialList={list:null,pagingTop:null,pagingBottom:null,pagingText:null,aSerial:[],pagingInfo:{currentPage:0,totalCount:0,perPage:cfg.itemsPerPage},init:function(){this.list=document.getElementById("list");this.pagingTop=document.getElementById("paging_top");this.pagingBottom=document.getElementById("paging_bottom");this.pagingText=document.getElementById("paging_text");this.pagingTop.onclick=function(){"disabled"!=this.className&&SerialList.show(SerialList.pagingInfo.currentPage-1)};this.pagingBottom.onclick=
function(){"disabled"!=this.className&&SerialList.show(SerialList.pagingInfo.currentPage+1)};for(j=0;j<this.pagingInfo.perPage;j++)this.list.children[j].onclick=this.selectSerial;var a=JSON.parse(window.localStorage.getItem("product")),c="";a&&(a=new Product(a),a.isSerialType()&&(c="Serie"),a.isBatchType()&&(c="Lote"),this.requestSerialList(a.ID,a.optionID,a.useSerial,a.useBatch));asl.title(c)},requestSerialList:function(a,c,b,d){ajaxRequest("GET","php/db/get_item_serial_list.php?ItemID="+a+"&combinationID="+
c+"&useSerial="+b+"&useBatch="+d,function(a){try{var b=JSON.parse(a);b&&(SerialList.aSerial=b);SerialList.show(0)}catch(c){alert(a)}})},show:function(a){var c=SerialList.aSerial;this.pagingInfo.currentPage=a;this.pagingInfo.totalCount=0<c.length?c.length:1;this.pagingText.innerText=a+1+"/"+Math.ceil(this.pagingInfo.totalCount/this.pagingInfo.perPage);for(var b=0,d=c.length-1-a*this.pagingInfo.perPage;0<=d&&b<this.pagingInfo.perPage;d--,b++)this.list.children[b].children[0].children[0].innerHTML=c[d].SerialBatch,
this.list.children[b].id=d,this.list.children[b].children[0].children[1].children[1].innerHTML=parseFloat(c[d].Quantity)||0,this.list.children[b].style.setProperty("visibility","visible");if(b<this.pagingInfo.perPage)for(b;b<this.pagingInfo.perPage;b++)this.list.children[b].children[0].children[0].innerHTML="Empty",this.list.children[b].style.setProperty("visibility","hidden");this.pagingBottom.className=a+1==Math.ceil(this.pagingInfo.totalCount/this.pagingInfo.perPage)?"disabled":"enabled";this.pagingTop.className=
0==a?"disabled":"enabled"},selectSerial:function(a){a=parseInt(a.currentTarget.id);window.localStorage.setItem("oSelectedSerial",JSON.stringify(SerialList.aSerial[a]));window.location="scan_product.html"}};function backToProducts(){window.location="scan_product.html"}asl.options(null);asl.back(backToProducts);asl.events.subscribe(asl.events.types.exit,function(){asl.badge(null);"function"==typeof asl.lock&&asl.lock(null)});asl.events.subscribe(asl.events.types.loaded,function(){SerialList.init()});